<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../protofile/ rel=prev><link href=../enum/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.0, mkdocs-material-9.1.21"><title>加密解密 - 喜马拉雅程序化广告</title><link rel=stylesheet href=../../assets/stylesheets/main.eebd395e.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ecc896b0.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-EN05JCCVTD"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-EN05JCCVTD",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-EN05JCCVTD",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=deep-orange data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#_1 class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../.. title=喜马拉雅程序化广告 class="md-header__button md-logo" aria-label=喜马拉雅程序化广告 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 喜马拉雅程序化广告 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 加密解密 </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=查找> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> 关于我们 </a> </li> <li class=md-tabs__item> <a href=../../mktapi/start/ class=md-tabs__link> Marketing API </a> </li> <li class=md-tabs__item> <a href=../../xmadx/ class=md-tabs__link> Ad-Exchange </a> </li> <li class=md-tabs__item> <a href=../statements/ class="md-tabs__link md-tabs__link--active"> OpenRTB API </a> </li> <li class=md-tabs__item> <a href=../../media/query/ class=md-tabs__link> 媒体查询 API </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=喜马拉雅程序化广告 class="md-nav__button md-logo" aria-label=喜马拉雅程序化广告 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> 喜马拉雅程序化广告 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> 关于我们 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> Marketing API <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Marketing API </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> 快速开始 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> 快速开始 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../mktapi/start/ class=md-nav__link> 从这里开始 </a> </li> <li class=md-nav__item> <a href=../../mktapi/accessToken/ class=md-nav__link> 刷新Access_Token </a> </li> <li class=md-nav__item> <a href=../../mktapi/queryDevInfo/ class=md-nav__link> 授权信息查询 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> 广告投放 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> 广告投放 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../mktapi/queryCampaign/ class=md-nav__link> 广告计划查询 </a> </li> <li class=md-nav__item> <a href=../../mktapi/queryAd/ class=md-nav__link> 广告单元查询 </a> </li> <li class=md-nav__item> <a href=../../mktapi/queryCreative/ class=md-nav__link> 广告创意查询 </a> </li> <li class=md-nav__item> <a href=../../mktapi/querySegment/ class=md-nav__link> 广告素材查询 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> 数据报表 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> 数据报表 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../mktapi/statement/ class=md-nav__link> 数据报表查询 </a> </li> <li class=md-nav__item> <a href=../../mktapi/queryStatementField/ class=md-nav__link> 数据报表域查询 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> 系统管理 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> 系统管理 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../mktapi/queryEnum/ class=md-nav__link> 枚举信息查询 </a> </li> <li class=md-nav__item> <a href=../../mktapi/queryOneEnum/ class=md-nav__link> 枚举信息精确查询 </a> </li> <li class=md-nav__item> <a href=../../mktapi/queryTarget/ class=md-nav__link> 定向信息查询 </a> </li> <li class=md-nav__item> <a href=../../mktapi/queryProvince/ class=md-nav__link> 地域信息查询 </a> </li> <li class=md-nav__item> <a href=../../mktapi/approvalLanch/ class=md-nav__link> 账户权限申请 </a> </li> <li class=md-nav__item> <a href=../../mktapi/errorCode/ class=md-nav__link> 错误码 </a> </li> <li class=md-nav__item> <a href=../../mktapi/versionCode/ class=md-nav__link> 版本说明 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../mktapi/reg/ class=md-nav__link> 注册 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../xmadx/ class=md-nav__link> Ad-Exchange </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> OpenRTB API <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> OpenRTB API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../statements/ class=md-nav__link> 基本说明 </a> </li> <li class=md-nav__item> <a href=../steps/ class=md-nav__link> 商务流程 </a> </li> <li class=md-nav__item> <a href=../protocol/ class=md-nav__link> 技术接口 </a> </li> <li class=md-nav__item> <a href=../protodesc/ class=md-nav__link> 接口格式 </a> </li> <li class=md-nav__item> <a href=../protofile/ class=md-nav__link> 协议文件 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 加密解密 <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> 加密解密 </a> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#java class=md-nav__link> Java </a> </li> <li class=md-nav__item> <a href=#golang class=md-nav__link> Golang </a> </li> <li class=md-nav__item> <a href=#php class=md-nav__link> PHP </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../enum/ class=md-nav__link> 枚举映射 </a> </li> <li class=md-nav__item> <a href=../protohistory/ class=md-nav__link> 历史协议 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> 媒体查询 API <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> 媒体查询 API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../media/query/ class=md-nav__link> 基本说明 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#java class=md-nav__link> Java </a> </li> <li class=md-nav__item> <a href=#golang class=md-nav__link> Golang </a> </li> <li class=md-nav__item> <a href=#php class=md-nav__link> PHP </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=_1>价格加解密示例</h1> <h2 id=java>Java</h2> <div class="language-java highlight"><span class=filename>java enc/decrypt</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>javax.crypto.*</span><span class=p>;</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=kn>import</span><span class=w> </span><span class=nn>javax.crypto.spec.SecretKeySpec</span><span class=p>;</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=kn>import</span><span class=w> </span><span class=nn>java.nio.charset.StandardCharsets</span><span class=p>;</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=kn>import</span><span class=w> </span><span class=nn>java.security.InvalidKeyException</span><span class=p>;</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=kn>import</span><span class=w> </span><span class=nn>java.security.NoSuchAlgorithmException</span><span class=p>;</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=kn>import</span><span class=w> </span><span class=nn>java.security.SecureRandom</span><span class=p>;</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>aesEcbPkcs5PaddingEncryptHex</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>content</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>key</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>NoSuchAlgorithmException</span><span class=p>,</span><span class=w> </span><span class=n>NoSuchPaddingException</span><span class=p>,</span><span class=w> </span><span class=n>InvalidKeyException</span><span class=p>,</span><span class=w> </span><span class=n>BadPaddingException</span><span class=p>,</span><span class=w> </span><span class=n>IllegalBlockSizeException</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=w>    </span><span class=kt>byte</span><span class=o>[]</span><span class=w> </span><span class=n>rawKey</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>key</span><span class=p>.</span><span class=na>getBytes</span><span class=p>(</span><span class=n>StandardCharsets</span><span class=p>.</span><span class=na>UTF_8</span><span class=p>);</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=w>    </span><span class=n>SecretKeySpec</span><span class=w> </span><span class=n>skeySpec</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SecretKeySpec</span><span class=p>(</span><span class=n>rawKey</span><span class=p>,</span><span class=w> </span><span class=s>&quot;AES&quot;</span><span class=p>);</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=w>    </span><span class=n>Cipher</span><span class=w> </span><span class=n>cipher</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Cipher</span><span class=p>.</span><span class=na>getInstance</span><span class=p>(</span><span class=s>&quot;AES/ECB/PKCS5Padding&quot;</span><span class=p>);</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=w>    </span><span class=n>cipher</span><span class=p>.</span><span class=na>init</span><span class=p>(</span><span class=n>Cipher</span><span class=p>.</span><span class=na>ENCRYPT_MODE</span><span class=p>,</span><span class=w> </span><span class=n>skeySpec</span><span class=p>);</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=w>    </span><span class=kt>byte</span><span class=o>[]</span><span class=w> </span><span class=n>encrypted</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cipher</span><span class=p>.</span><span class=na>doFinal</span><span class=p>(</span><span class=n>content</span><span class=p>.</span><span class=na>getBytes</span><span class=p>(</span><span class=n>StandardCharsets</span><span class=p>.</span><span class=na>UTF_8</span><span class=p>));</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>Hex</span><span class=p>.</span><span class=na>encodeHexString</span><span class=p>(</span><span class=n>encrypted</span><span class=p>);</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=p>}</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>aesEcbPkcs5PaddingDecryptHex</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>encryptedHex</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>key</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>NoSuchAlgorithmException</span><span class=p>,</span><span class=w> </span><span class=n>NoSuchPaddingException</span><span class=p>,</span><span class=w> </span><span class=n>InvalidKeyException</span><span class=p>,</span><span class=w> </span><span class=n>BadPaddingException</span><span class=p>,</span><span class=w> </span><span class=n>IllegalBlockSizeException</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=w>    </span><span class=kt>byte</span><span class=o>[]</span><span class=w> </span><span class=n>rawKey</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>key</span><span class=p>.</span><span class=na>getBytes</span><span class=p>(</span><span class=n>StandardCharsets</span><span class=p>.</span><span class=na>UTF_8</span><span class=p>);</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=w>    </span><span class=n>SecretKeySpec</span><span class=w> </span><span class=n>skeySpec</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SecretKeySpec</span><span class=p>(</span><span class=n>rawKey</span><span class=p>,</span><span class=w> </span><span class=s>&quot;AES&quot;</span><span class=p>);</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=w>    </span><span class=n>Cipher</span><span class=w> </span><span class=n>cipher</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Cipher</span><span class=p>.</span><span class=na>getInstance</span><span class=p>(</span><span class=s>&quot;AES/ECB/PKCS5Padding&quot;</span><span class=p>);</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=w>    </span><span class=n>cipher</span><span class=p>.</span><span class=na>init</span><span class=p>(</span><span class=n>Cipher</span><span class=p>.</span><span class=na>DECRYPT_MODE</span><span class=p>,</span><span class=w> </span><span class=n>skeySpec</span><span class=p>);</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=w>    </span><span class=kt>byte</span><span class=o>[]</span><span class=w> </span><span class=n>encrypted</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Hex</span><span class=p>.</span><span class=na>decodeHex</span><span class=p>(</span><span class=n>encryptedHex</span><span class=p>);</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a><span class=w>    </span><span class=kt>byte</span><span class=o>[]</span><span class=w> </span><span class=n>decrypted</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cipher</span><span class=p>.</span><span class=na>doFinal</span><span class=p>(</span><span class=n>encrypted</span><span class=p>);</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>String</span><span class=p>(</span><span class=n>decrypted</span><span class=p>,</span><span class=w> </span><span class=n>StandardCharsets</span><span class=p>.</span><span class=na>UTF_8</span><span class=p>);</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a><span class=p>}</span>
</span></code></pre></div> <h2 id=golang>Golang</h2> <p>实现了自定义的 ECB 加密器和解密器，以模拟 Java 中的 AES/ECB/PKCS5Padding 加密和解密, 此外还添加了用于 PKCS5 填充和去填充的辅助函数</p> <div class="language-golang highlight"><span class=filename>golang enc/decrypt</span><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>package</span><span class=w> </span><span class=nx>main</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=kn>import</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>    </span><span class=s>&quot;crypto/aes&quot;</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>    </span><span class=s>&quot;crypto/cipher&quot;</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=w>    </span><span class=s>&quot;crypto/rand&quot;</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=w>    </span><span class=s>&quot;encoding/hex&quot;</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=w>    </span><span class=s>&quot;fmt&quot;</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=w>    </span><span class=s>&quot;io&quot;</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=p>)</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=kd>func</span><span class=w> </span><span class=nx>aesEcbPkcs5PaddingEncryptHex</span><span class=p>(</span><span class=nx>content</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>key</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=w>    </span><span class=nx>rawKey</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>key</span><span class=p>)</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=w>    </span><span class=nx>block</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>aes</span><span class=p>.</span><span class=nx>NewCipher</span><span class=p>(</span><span class=nx>rawKey</span><span class=p>)</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&quot;&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=w>    </span><span class=nx>contentBytes</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>content</span><span class=p>)</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=w>    </span><span class=nx>paddedContent</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>pkcs5Padding</span><span class=p>(</span><span class=nx>contentBytes</span><span class=p>,</span><span class=w> </span><span class=nx>aes</span><span class=p>.</span><span class=nx>BlockSize</span><span class=p>)</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=w>    </span><span class=nx>encrypted</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>paddedContent</span><span class=p>))</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a><span class=w>    </span><span class=nx>ecb</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>NewECBEncrypter</span><span class=p>(</span><span class=nx>block</span><span class=p>)</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=w>    </span><span class=nx>ecb</span><span class=p>.</span><span class=nx>CryptBlocks</span><span class=p>(</span><span class=nx>encrypted</span><span class=p>,</span><span class=w> </span><span class=nx>paddedContent</span><span class=p>)</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>hex</span><span class=p>.</span><span class=nx>EncodeToString</span><span class=p>(</span><span class=nx>encrypted</span><span class=p>),</span><span class=w> </span><span class=kc>nil</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=p>}</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=kd>func</span><span class=w> </span><span class=nx>aesEcbPkcs5PaddingDecryptHex</span><span class=p>(</span><span class=nx>encryptedHex</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>key</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=w>    </span><span class=nx>rawKey</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>key</span><span class=p>)</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a><span class=w>    </span><span class=nx>block</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>aes</span><span class=p>.</span><span class=nx>NewCipher</span><span class=p>(</span><span class=nx>rawKey</span><span class=p>)</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&quot;&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a><span class=w>    </span><span class=nx>encrypted</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>hex</span><span class=p>.</span><span class=nx>DecodeString</span><span class=p>(</span><span class=nx>encryptedHex</span><span class=p>)</span>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&quot;&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span>
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a>
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a><span class=w>    </span><span class=nx>decrypted</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>encrypted</span><span class=p>))</span>
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a><span class=w>    </span><span class=nx>ecb</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>NewECBDecrypter</span><span class=p>(</span><span class=nx>block</span><span class=p>)</span>
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a><span class=w>    </span><span class=nx>ecb</span><span class=p>.</span><span class=nx>CryptBlocks</span><span class=p>(</span><span class=nx>decrypted</span><span class=p>,</span><span class=w> </span><span class=nx>encrypted</span><span class=p>)</span>
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a>
</span><span id=__span-1-45><a id=__codelineno-1-45 name=__codelineno-1-45 href=#__codelineno-1-45></a><span class=w>    </span><span class=nx>unpaddedContent</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>pkcs5Unpadding</span><span class=p>(</span><span class=nx>decrypted</span><span class=p>)</span>
</span><span id=__span-1-46><a id=__codelineno-1-46 name=__codelineno-1-46 href=#__codelineno-1-46></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-47><a id=__codelineno-1-47 name=__codelineno-1-47 href=#__codelineno-1-47></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&quot;&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span>
</span><span id=__span-1-48><a id=__codelineno-1-48 name=__codelineno-1-48 href=#__codelineno-1-48></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-49><a id=__codelineno-1-49 name=__codelineno-1-49 href=#__codelineno-1-49></a>
</span><span id=__span-1-50><a id=__codelineno-1-50 name=__codelineno-1-50 href=#__codelineno-1-50></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>string</span><span class=p>(</span><span class=nx>unpaddedContent</span><span class=p>),</span><span class=w> </span><span class=kc>nil</span>
</span><span id=__span-1-51><a id=__codelineno-1-51 name=__codelineno-1-51 href=#__codelineno-1-51></a><span class=p>}</span>
</span><span id=__span-1-52><a id=__codelineno-1-52 name=__codelineno-1-52 href=#__codelineno-1-52></a>
</span><span id=__span-1-53><a id=__codelineno-1-53 name=__codelineno-1-53 href=#__codelineno-1-53></a><span class=kd>func</span><span class=w> </span><span class=nx>pkcs5Padding</span><span class=p>(</span><span class=nx>data</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=nx>blockSize</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-54><a id=__codelineno-1-54 name=__codelineno-1-54 href=#__codelineno-1-54></a><span class=w>    </span><span class=nx>padding</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>blockSize</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=nx>blockSize</span><span class=p>)</span>
</span><span id=__span-1-55><a id=__codelineno-1-55 name=__codelineno-1-55 href=#__codelineno-1-55></a><span class=w>    </span><span class=nx>padText</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>bytes</span><span class=p>.</span><span class=nx>Repeat</span><span class=p>([]</span><span class=kt>byte</span><span class=p>{</span><span class=nb>byte</span><span class=p>(</span><span class=nx>padding</span><span class=p>)},</span><span class=w> </span><span class=nx>padding</span><span class=p>)</span>
</span><span id=__span-1-56><a id=__codelineno-1-56 name=__codelineno-1-56 href=#__codelineno-1-56></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>append</span><span class=p>(</span><span class=nx>data</span><span class=p>,</span><span class=w> </span><span class=nx>padText</span><span class=o>...</span><span class=p>)</span>
</span><span id=__span-1-57><a id=__codelineno-1-57 name=__codelineno-1-57 href=#__codelineno-1-57></a><span class=p>}</span>
</span><span id=__span-1-58><a id=__codelineno-1-58 name=__codelineno-1-58 href=#__codelineno-1-58></a>
</span><span id=__span-1-59><a id=__codelineno-1-59 name=__codelineno-1-59 href=#__codelineno-1-59></a><span class=kd>func</span><span class=w> </span><span class=nx>pkcs5Unpadding</span><span class=p>(</span><span class=nx>data</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-60><a id=__codelineno-1-60 name=__codelineno-1-60 href=#__codelineno-1-60></a><span class=w>    </span><span class=nx>length</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span>
</span><span id=__span-1-61><a id=__codelineno-1-61 name=__codelineno-1-61 href=#__codelineno-1-61></a><span class=w>    </span><span class=nx>unpadding</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nb>int</span><span class=p>(</span><span class=nx>data</span><span class=p>[</span><span class=nx>length</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-1-62><a id=__codelineno-1-62 name=__codelineno-1-62 href=#__codelineno-1-62></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>unpadding</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=nx>length</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-63><a id=__codelineno-1-63 name=__codelineno-1-63 href=#__codelineno-1-63></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>errors</span><span class=p>.</span><span class=nx>New</span><span class=p>(</span><span class=s>&quot;Invalid padding&quot;</span><span class=p>)</span>
</span><span id=__span-1-64><a id=__codelineno-1-64 name=__codelineno-1-64 href=#__codelineno-1-64></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-65><a id=__codelineno-1-65 name=__codelineno-1-65 href=#__codelineno-1-65></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>data</span><span class=p>[:(</span><span class=nx>length</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nx>unpadding</span><span class=p>)],</span><span class=w> </span><span class=kc>nil</span>
</span><span id=__span-1-66><a id=__codelineno-1-66 name=__codelineno-1-66 href=#__codelineno-1-66></a><span class=p>}</span>
</span><span id=__span-1-67><a id=__codelineno-1-67 name=__codelineno-1-67 href=#__codelineno-1-67></a>
</span><span id=__span-1-68><a id=__codelineno-1-68 name=__codelineno-1-68 href=#__codelineno-1-68></a><span class=kd>type</span><span class=w> </span><span class=nx>ecbEncrypter</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-69><a id=__codelineno-1-69 name=__codelineno-1-69 href=#__codelineno-1-69></a><span class=w>    </span><span class=nx>b</span><span class=w>         </span><span class=nx>cipher</span><span class=p>.</span><span class=nx>Block</span>
</span><span id=__span-1-70><a id=__codelineno-1-70 name=__codelineno-1-70 href=#__codelineno-1-70></a><span class=w>    </span><span class=nx>blockSize</span><span class=w> </span><span class=kt>int</span>
</span><span id=__span-1-71><a id=__codelineno-1-71 name=__codelineno-1-71 href=#__codelineno-1-71></a><span class=p>}</span>
</span><span id=__span-1-72><a id=__codelineno-1-72 name=__codelineno-1-72 href=#__codelineno-1-72></a>
</span><span id=__span-1-73><a id=__codelineno-1-73 name=__codelineno-1-73 href=#__codelineno-1-73></a><span class=kd>func</span><span class=w> </span><span class=nx>NewECBEncrypter</span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=nx>cipher</span><span class=p>.</span><span class=nx>Block</span><span class=p>)</span><span class=w> </span><span class=nx>cipher</span><span class=p>.</span><span class=nx>BlockMode</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-74><a id=__codelineno-1-74 name=__codelineno-1-74 href=#__codelineno-1-74></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>ecbEncrypter</span><span class=p>{</span>
</span><span id=__span-1-75><a id=__codelineno-1-75 name=__codelineno-1-75 href=#__codelineno-1-75></a><span class=w>        </span><span class=nx>b</span><span class=p>:</span><span class=w>         </span><span class=nx>b</span><span class=p>,</span>
</span><span id=__span-1-76><a id=__codelineno-1-76 name=__codelineno-1-76 href=#__codelineno-1-76></a><span class=w>        </span><span class=nx>blockSize</span><span class=p>:</span><span class=w> </span><span class=nx>b</span><span class=p>.</span><span class=nx>BlockSize</span><span class=p>(),</span>
</span><span id=__span-1-77><a id=__codelineno-1-77 name=__codelineno-1-77 href=#__codelineno-1-77></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-78><a id=__codelineno-1-78 name=__codelineno-1-78 href=#__codelineno-1-78></a><span class=p>}</span>
</span><span id=__span-1-79><a id=__codelineno-1-79 name=__codelineno-1-79 href=#__codelineno-1-79></a>
</span><span id=__span-1-80><a id=__codelineno-1-80 name=__codelineno-1-80 href=#__codelineno-1-80></a><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>x</span><span class=w> </span><span class=o>*</span><span class=nx>ecbEncrypter</span><span class=p>)</span><span class=w> </span><span class=nx>BlockSize</span><span class=p>()</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=nx>x</span><span class=p>.</span><span class=nx>blockSize</span><span class=w> </span><span class=p>}</span>
</span><span id=__span-1-81><a id=__codelineno-1-81 name=__codelineno-1-81 href=#__codelineno-1-81></a>
</span><span id=__span-1-82><a id=__codelineno-1-82 name=__codelineno-1-82 href=#__codelineno-1-82></a><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>x</span><span class=w> </span><span class=o>*</span><span class=nx>ecbEncrypter</span><span class=p>)</span><span class=w> </span><span class=nx>CryptBlocks</span><span class=p>(</span><span class=nx>dst</span><span class=p>,</span><span class=w> </span><span class=nx>src</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-83><a id=__codelineno-1-83 name=__codelineno-1-83 href=#__codelineno-1-83></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>src</span><span class=p>)</span><span class=o>%</span><span class=nx>x</span><span class=p>.</span><span class=nx>blockSize</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-84><a id=__codelineno-1-84 name=__codelineno-1-84 href=#__codelineno-1-84></a><span class=w>        </span><span class=nb>panic</span><span class=p>(</span><span class=s>&quot;crypto/cipher: input not full blocks&quot;</span><span class=p>)</span>
</span><span id=__span-1-85><a id=__codelineno-1-85 name=__codelineno-1-85 href=#__codelineno-1-85></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-86><a id=__codelineno-1-86 name=__codelineno-1-86 href=#__codelineno-1-86></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>dst</span><span class=p>)</span><span class=w> </span><span class=p>&lt;</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>src</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-87><a id=__codelineno-1-87 name=__codelineno-1-87 href=#__codelineno-1-87></a><span class=w>        </span><span class=nb>panic</span><span class=p>(</span><span class=s>&quot;crypto/cipher: output smaller than input&quot;</span><span class=p>)</span>
</span><span id=__span-1-88><a id=__codelineno-1-88 name=__codelineno-1-88 href=#__codelineno-1-88></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-89><a id=__codelineno-1-89 name=__codelineno-1-89 href=#__codelineno-1-89></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>src</span><span class=p>)</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-90><a id=__codelineno-1-90 name=__codelineno-1-90 href=#__codelineno-1-90></a><span class=w>        </span><span class=nx>x</span><span class=p>.</span><span class=nx>b</span><span class=p>.</span><span class=nx>Encrypt</span><span class=p>(</span><span class=nx>dst</span><span class=p>,</span><span class=w> </span><span class=nx>src</span><span class=p>[:</span><span class=nx>x</span><span class=p>.</span><span class=nx>blockSize</span><span class=p>])</span>
</span><span id=__span-1-91><a id=__codelineno-1-91 name=__codelineno-1-91 href=#__codelineno-1-91></a><span class=w>        </span><span class=nx>src</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>src</span><span class=p>[</span><span class=nx>x</span><span class=p>.</span><span class=nx>blockSize</span><span class=p>:]</span>
</span><span id=__span-1-92><a id=__codelineno-1-92 name=__codelineno-1-92 href=#__codelineno-1-92></a><span class=w>        </span><span class=nx>dst</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>dst</span><span class=p>[</span><span class=nx>x</span><span class=p>.</span><span class=nx>blockSize</span><span class=p>:]</span>
</span><span id=__span-1-93><a id=__codelineno-1-93 name=__codelineno-1-93 href=#__codelineno-1-93></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-94><a id=__codelineno-1-94 name=__codelineno-1-94 href=#__codelineno-1-94></a><span class=p>}</span>
</span><span id=__span-1-95><a id=__codelineno-1-95 name=__codelineno-1-95 href=#__codelineno-1-95></a>
</span><span id=__span-1-96><a id=__codelineno-1-96 name=__codelineno-1-96 href=#__codelineno-1-96></a><span class=kd>type</span><span class=w> </span><span class=nx>ecbDecrypter</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-97><a id=__codelineno-1-97 name=__codelineno-1-97 href=#__codelineno-1-97></a><span class=w>    </span><span class=nx>b</span><span class=w>         </span><span class=nx>cipher</span><span class=p>.</span><span class=nx>Block</span>
</span><span id=__span-1-98><a id=__codelineno-1-98 name=__codelineno-1-98 href=#__codelineno-1-98></a><span class=w>    </span><span class=nx>blockSize</span><span class=w> </span><span class=kt>int</span>
</span><span id=__span-1-99><a id=__codelineno-1-99 name=__codelineno-1-99 href=#__codelineno-1-99></a><span class=p>}</span>
</span><span id=__span-1-100><a id=__codelineno-1-100 name=__codelineno-1-100 href=#__codelineno-1-100></a>
</span><span id=__span-1-101><a id=__codelineno-1-101 name=__codelineno-1-101 href=#__codelineno-1-101></a><span class=kd>func</span><span class=w> </span><span class=nx>NewECBDecrypter</span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=nx>cipher</span><span class=p>.</span><span class=nx>Block</span><span class=p>)</span><span class=w> </span><span class=nx>cipher</span><span class=p>.</span><span class=nx>BlockMode</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-102><a id=__codelineno-1-102 name=__codelineno-1-102 href=#__codelineno-1-102></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>ecbDecrypter</span><span class=p>{</span>
</span><span id=__span-1-103><a id=__codelineno-1-103 name=__codelineno-1-103 href=#__codelineno-1-103></a><span class=w>        </span><span class=nx>b</span><span class=p>:</span><span class=w>         </span><span class=nx>b</span><span class=p>,</span>
</span><span id=__span-1-104><a id=__codelineno-1-104 name=__codelineno-1-104 href=#__codelineno-1-104></a><span class=w>        </span><span class=nx>blockSize</span><span class=p>:</span><span class=w> </span><span class=nx>b</span><span class=p>.</span><span class=nx>BlockSize</span><span class=p>(),</span>
</span><span id=__span-1-105><a id=__codelineno-1-105 name=__codelineno-1-105 href=#__codelineno-1-105></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-106><a id=__codelineno-1-106 name=__codelineno-1-106 href=#__codelineno-1-106></a><span class=p>}</span>
</span><span id=__span-1-107><a id=__codelineno-1-107 name=__codelineno-1-107 href=#__codelineno-1-107></a>
</span><span id=__span-1-108><a id=__codelineno-1-108 name=__codelineno-1-108 href=#__codelineno-1-108></a><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>x</span><span class=w> </span><span class=o>*</span><span class=nx>ecbDecrypter</span><span class=p>)</span><span class=w> </span><span class=nx>BlockSize</span><span class=p>()</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=nx>x</span><span class=p>.</span><span class=nx>blockSize</span><span class=w> </span><span class=p>}</span>
</span><span id=__span-1-109><a id=__codelineno-1-109 name=__codelineno-1-109 href=#__codelineno-1-109></a>
</span><span id=__span-1-110><a id=__codelineno-1-110 name=__codelineno-1-110 href=#__codelineno-1-110></a><span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>x</span><span class=w> </span><span class=o>*</span><span class=nx>ecbDecrypter</span><span class=p>)</span><span class=w> </span><span class=nx>CryptBlocks</span><span class=p>(</span><span class=nx>dst</span><span class=p>,</span><span class=w> </span><span class=nx>src</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-111><a id=__codelineno-1-111 name=__codelineno-1-111 href=#__codelineno-1-111></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>src</span><span class=p>)</span><span class=o>%</span><span class=nx>x</span><span class=p>.</span><span class=nx>blockSize</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-112><a id=__codelineno-1-112 name=__codelineno-1-112 href=#__codelineno-1-112></a><span class=w>        </span><span class=nb>panic</span><span class=p>(</span><span class=s>&quot;crypto/cipher: input not full blocks&quot;</span><span class=p>)</span>
</span><span id=__span-1-113><a id=__codelineno-1-113 name=__codelineno-1-113 href=#__codelineno-1-113></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-114><a id=__codelineno-1-114 name=__codelineno-1-114 href=#__codelineno-1-114></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>dst</span><span class=p>)</span><span class=w> </span><span class=p>&lt;</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>src</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-115><a id=__codelineno-1-115 name=__codelineno-1-115 href=#__codelineno-1-115></a><span class=w>        </span><span class=nb>panic</span><span class=p>(</span><span class=s>&quot;crypto/cipher: output smaller than input&quot;</span><span class=p>)</span>
</span><span id=__span-1-116><a id=__codelineno-1-116 name=__codelineno-1-116 href=#__codelineno-1-116></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-117><a id=__codelineno-1-117 name=__codelineno-1-117 href=#__codelineno-1-117></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>src</span><span class=p>)</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-118><a id=__codelineno-1-118 name=__codelineno-1-118 href=#__codelineno-1-118></a><span class=w>        </span><span class=nx>x</span><span class=p>.</span><span class=nx>b</span><span class=p>.</span><span class=nx>Decrypt</span><span class=p>(</span><span class=nx>dst</span><span class=p>,</span><span class=w> </span><span class=nx>src</span><span class=p>[:</span><span class=nx>x</span><span class=p>.</span><span class=nx>blockSize</span><span class=p>])</span>
</span><span id=__span-1-119><a id=__codelineno-1-119 name=__codelineno-1-119 href=#__codelineno-1-119></a><span class=w>        </span><span class=nx>src</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>src</span><span class=p>[</span><span class=nx>x</span><span class=p>.</span><span class=nx>blockSize</span><span class=p>:]</span>
</span><span id=__span-1-120><a id=__codelineno-1-120 name=__codelineno-1-120 href=#__codelineno-1-120></a><span class=w>        </span><span class=nx>dst</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>dst</span><span class=p>[</span><span class=nx>x</span><span class=p>.</span><span class=nx>blockSize</span><span class=p>:]</span>
</span><span id=__span-1-121><a id=__codelineno-1-121 name=__codelineno-1-121 href=#__codelineno-1-121></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-122><a id=__codelineno-1-122 name=__codelineno-1-122 href=#__codelineno-1-122></a><span class=p>}</span>
</span><span id=__span-1-123><a id=__codelineno-1-123 name=__codelineno-1-123 href=#__codelineno-1-123></a>
</span><span id=__span-1-124><a id=__codelineno-1-124 name=__codelineno-1-124 href=#__codelineno-1-124></a><span class=kd>func</span><span class=w> </span><span class=nx>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-125><a id=__codelineno-1-125 name=__codelineno-1-125 href=#__codelineno-1-125></a><span class=w>    </span><span class=nx>content</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&quot;Hello, World!&quot;</span>
</span><span id=__span-1-126><a id=__codelineno-1-126 name=__codelineno-1-126 href=#__codelineno-1-126></a><span class=w>    </span><span class=nx>key</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&quot;0123456789abcdef&quot;</span>
</span><span id=__span-1-127><a id=__codelineno-1-127 name=__codelineno-1-127 href=#__codelineno-1-127></a>
</span><span id=__span-1-128><a id=__codelineno-1-128 name=__codelineno-1-128 href=#__codelineno-1-128></a><span class=w>    </span><span class=nx>encryptedHex</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>aesEcbPkcs5PaddingEncryptHex</span><span class=p>(</span><span class=nx>content</span><span class=p>,</span><span class=w> </span><span class=nx>key</span><span class=p>)</span>
</span><span id=__span-1-129><a id=__codelineno-1-129 name=__codelineno-1-129 href=#__codelineno-1-129></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-130><a id=__codelineno-1-130 name=__codelineno-1-130 href=#__codelineno-1-130></a><span class=w>        </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=s>&quot;Encryption error:&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span>
</span><span id=__span-1-131><a id=__codelineno-1-131 name=__codelineno-1-131 href=#__codelineno-1-131></a><span class=w>        </span><span class=k>return</span>
</span><span id=__span-1-132><a id=__codelineno-1-132 name=__codelineno-1-132 href=#__codelineno-1-132></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-133><a id=__codelineno-1-133 name=__codelineno-1-133 href=#__codelineno-1-133></a>
</span><span id=__span-1-134><a id=__codelineno-1-134 name=__codelineno-1-134 href=#__codelineno-1-134></a><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=s>&quot;Encrypted Hex:&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>encryptedHex</span><span class=p>)</span>
</span><span id=__span-1-135><a id=__codelineno-1-135 name=__codelineno-1-135 href=#__codelineno-1-135></a>
</span><span id=__span-1-136><a id=__codelineno-1-136 name=__codelineno-1-136 href=#__codelineno-1-136></a><span class=w>    </span><span class=nx>decrypted</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>aesEcbPkcs5PaddingDecryptHex</span><span class=p>(</span><span class=nx>encryptedHex</span><span class=p>,</span><span class=w> </span><span class=nx>key</span><span class=p>)</span>
</span><span id=__span-1-137><a id=__codelineno-1-137 name=__codelineno-1-137 href=#__codelineno-1-137></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-138><a id=__codelineno-1-138 name=__codelineno-1-138 href=#__codelineno-1-138></a><span class=w>        </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=s>&quot;Decryption error:&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=p>)</span>
</span><span id=__span-1-139><a id=__codelineno-1-139 name=__codelineno-1-139 href=#__codelineno-1-139></a><span class=w>        </span><span class=k>return</span>
</span><span id=__span-1-140><a id=__codelineno-1-140 name=__codelineno-1-140 href=#__codelineno-1-140></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-141><a id=__codelineno-1-141 name=__codelineno-1-141 href=#__codelineno-1-141></a>
</span><span id=__span-1-142><a id=__codelineno-1-142 name=__codelineno-1-142 href=#__codelineno-1-142></a><span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=s>&quot;Decrypted:&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>decrypted</span><span class=p>)</span>
</span><span id=__span-1-143><a id=__codelineno-1-143 name=__codelineno-1-143 href=#__codelineno-1-143></a><span class=p>}</span>
</span></code></pre></div> <h2 id=php>PHP</h2> <div class="language-php highlight"><span class=filename>php enc/decrypt</span><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=cp>&lt;?php</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=k>function</span> <span class=nf>aesEcbPkcs5PaddingEncryptHex</span><span class=p>(</span><span class=nv>$content</span><span class=p>,</span> <span class=nv>$key</span><span class=p>)</span> <span class=p>{</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>    <span class=nv>$rawKey</span> <span class=o>=</span> <span class=nb>mb_convert_encoding</span><span class=p>(</span><span class=nv>$key</span><span class=p>,</span> <span class=s1>&#39;UTF-8&#39;</span><span class=p>);</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>    <span class=nv>$skeySpec</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>\stdClass</span><span class=p>();</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>    <span class=nv>$skeySpec</span><span class=o>-&gt;</span><span class=na>key</span> <span class=o>=</span> <span class=nv>$rawKey</span><span class=p>;</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>    <span class=nv>$skeySpec</span><span class=o>-&gt;</span><span class=na>algorithm</span> <span class=o>=</span> <span class=s1>&#39;AES&#39;</span><span class=p>;</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>    <span class=nv>$cipher</span> <span class=o>=</span> <span class=nb>openssl_encrypt</span><span class=p>(</span><span class=nv>$content</span><span class=p>,</span> <span class=s1>&#39;AES-128-ECB&#39;</span><span class=p>,</span> <span class=nv>$skeySpec</span><span class=o>-&gt;</span><span class=na>key</span><span class=p>,</span> <span class=nx>OPENSSL_RAW_DATA</span><span class=p>);</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>    <span class=nv>$encrypted</span> <span class=o>=</span> <span class=nb>bin2hex</span><span class=p>(</span><span class=nv>$cipher</span><span class=p>);</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>    <span class=k>return</span> <span class=nv>$encrypted</span><span class=p>;</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=p>}</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=k>function</span> <span class=nf>aesEcbPkcs5PaddingDecryptHex</span><span class=p>(</span><span class=nv>$encryptedHex</span><span class=p>,</span> <span class=nv>$key</span><span class=p>)</span> <span class=p>{</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>    <span class=nv>$rawKey</span> <span class=o>=</span> <span class=nb>mb_convert_encoding</span><span class=p>(</span><span class=nv>$key</span><span class=p>,</span> <span class=s1>&#39;UTF-8&#39;</span><span class=p>);</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>    <span class=nv>$skeySpec</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>\stdClass</span><span class=p>();</span>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>    <span class=nv>$skeySpec</span><span class=o>-&gt;</span><span class=na>key</span> <span class=o>=</span> <span class=nv>$rawKey</span><span class=p>;</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>    <span class=nv>$skeySpec</span><span class=o>-&gt;</span><span class=na>algorithm</span> <span class=o>=</span> <span class=s1>&#39;AES&#39;</span><span class=p>;</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a>    <span class=nv>$encrypted</span> <span class=o>=</span> <span class=nb>hex2bin</span><span class=p>(</span><span class=nv>$encryptedHex</span><span class=p>);</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a>    <span class=nv>$decrypted</span> <span class=o>=</span> <span class=nb>openssl_decrypt</span><span class=p>(</span><span class=nv>$encrypted</span><span class=p>,</span> <span class=s1>&#39;AES-128-ECB&#39;</span><span class=p>,</span> <span class=nv>$skeySpec</span><span class=o>-&gt;</span><span class=na>key</span><span class=p>,</span> <span class=nx>OPENSSL_RAW_DATA</span><span class=p>);</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a>    <span class=k>return</span> <span class=nv>$decrypted</span><span class=p>;</span>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=p>}</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=nv>$content</span> <span class=o>=</span> <span class=s2>&quot;Hello, World!&quot;</span><span class=p>;</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=nv>$key</span> <span class=o>=</span> <span class=s2>&quot;0123456789abcdef&quot;</span><span class=p>;</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a>
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=nv>$encryptedHex</span> <span class=o>=</span> <span class=nx>aesEcbPkcs5PaddingEncryptHex</span><span class=p>(</span><span class=nv>$content</span><span class=p>,</span> <span class=nv>$key</span><span class=p>);</span>
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=k>echo</span> <span class=s2>&quot;Encrypted Hex: &quot;</span> <span class=o>.</span> <span class=nv>$encryptedHex</span> <span class=o>.</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>;</span>
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a>
</span><span id=__span-2-32><a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=nv>$decrypted</span> <span class=o>=</span> <span class=nx>aesEcbPkcs5PaddingDecryptHex</span><span class=p>(</span><span class=nv>$encryptedHex</span><span class=p>,</span> <span class=nv>$key</span><span class=p>);</span>
</span><span id=__span-2-33><a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=k>echo</span> <span class=s2>&quot;Decrypted: &quot;</span> <span class=o>.</span> <span class=nv>$decrypted</span> <span class=o>.</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>;</span>
</span></code></pre></div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">同意</button> <label class=md-button for=__settings>管理设定</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.code.select", "content.code.copy", "navigation.tracking", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script> <script src=../../assets/javascripts/bundle.220ee61c.min.js></script> </body> </html>